name: DeployNewVersion

on:
  push:
    branches:
      - master
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2

    - name: Configure folder to MultiMC
      run: |
        sudo mkdir /OnixMC
        sudo mkdir /OnixMC/.minecraft
        cp -a /mods /OnixMC/.minecraft/
        cp -a /config /OnixMC/.minecraft/
        cp -a /server-icon.png /OnixMC/
        cd OnixMC
        ls
        cd .minecraft
        ls

    - name: Create Zip File
      uses: thedoctor0/zip-release@master
      with:
        filename: 'technic.zip'
        exclusions: '*.git* *.github* README.md server-icon.png *OnixMC*'

    - name: List Files
      run: ls

    - name: Upload Release Version
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.TOKEN }}
        file: technic.zip
        asset_name: modpack.zip
        tag: pack_1
        overwrite: true

    - name: Notify Discord
      uses: rjstone/discord-webhook-notify@v1
      with:
        severity: info
        webhookUrl: ${{ secrets.DISCORD_WEBHOOK }}
        username: OnixMC
        color: '#f78520'
        avatarUrl: 'https://raw.githubusercontent.com/OnixMC/OnixPacks/master/server-icon.png'
        description: Nova vers√£o do modpack disponibilizada.
        # details: 'http://api.technicpack.net/modpack/modpack_name'
